\input{src/preamble.tex}

\begin{document}
  \frame[plain]{\titlepage}

  \frame[plain]{
    \frametitle{}
    \LARGE{\textbf{Überblick}}
    \vspace{1em}
    \large
    \begin{enumerate}
      \item Problemstellung
      \item Umsetzung des Transpilers
      \item Ergebnisse und Auswertung
      \item Zusammenfassung
    \end{enumerate}
  }

  \section{Problemstellung}
    \secframe{1}{Problemstellung}

    \begin{frame}
      \frametitle{Motivation}
      \begin{itemize}
        \item JavaScripts \textbf{dynamische Typisierung} erschwert die Entwicklung korrekter, sicherer und wartbarer Anwendungen~\autocite{NIKHIL:2014,PRADEL:2015,BIERMAN:2014}
        \item Typ von Werten wird zur Laufzeit implizit umgewandelt (\textit{type coercion})
        \item Kritisches Laufzeitverhalten wird zum Teil ignoriert
        \item aber: bessere Typsicherheit durch Einsatz eines\\\textbf{statischen Typsystems} möglich
        \item Zwei Vertreter: \textit{Flow}~\autocite{FLOW:PAPER} und \textit{TypeScript}~\autocite{TYPESCRIPT:SPEC}
      \end{itemize}
    \end{frame}

    \begin{frame}[fragile]
      \frametitle{Beispiel -- Statische Typisierung durch Flow}
      \begin{lstlisting}
function linearSearch<T>(list: Array<T>, searchValue: T): number | null {
  for (const [index, value] of list.entries()) {
    if (value === searchValue) {
      return index;
    }
  }
  return null;
}

linearSearch<number>([3, 56, 10], 56);           // 1
linearSearch<number>([3, 56, 10], 12);           // null
linearSearch<string>(['foo', 'bar', 'baz'], 3);  // Typfehler
      \end{lstlisting}
    \end{frame}

    \frame{
      \frametitle{Zielsetzung der Masterarbeit}
      \begin{itemize}
        \item Ausgangslage: \textit{Spreadshirt} setzt Flow zur statischen Typisierung von JavaScript-Anwendungen ein
        \item Ziel: Migration bestehender Flow"=Projekte nach TypeScript
        \item Händische Migration fehleranfällig und zeitaufwändig
        \item Lösung: Entwicklung eines \textbf{Transpilers} zur Übersetzung der Flow-Typisierung nach TypeScript
        \item Transpiler = Compiler, der Quelltext einer Programmier"=sprache in eine andere übersetzt
      \end{itemize}
    }

    \begin{frame}[fragile]
      \frametitle{Beispiel einer Typ-Übersetzung}

      \begin{lstlisting}[
        numbers=none,
        emph={number,null,undefined}
      ]
// Flow
type MaybeNumber = ?number;


// TypeScript
type MaybeNumber = number | null | undefined;
      \end{lstlisting}
    \end{frame}

    \begin{frame}
      \frametitle{Ziele der Migration zu TypeScript}
      \begin{enumerate}
        \item Erkennung weiterer Typ- und Programmfehler
        \item Unterstützung externer Bibliotheken
        \item Performance der Typüberprüfungen
        \item Zukunftssicherheit und Transparenz der Technologie
      \end{enumerate}
    \end{frame}

  \section{Umsetzung}
    \secframe{2}{Umsetzung}

    \begin{frame}
      \frametitle{Technische Anforderungen an den Transpiler}
      \begin{enumerate}
        \item Äquivalente und vollständige Übersetzung der Flow-Typen
        \item Beibehaltung der Programmsemantik
        \item Unterstützung aktueller und vorläufiger JavaScript- sowie JSX-Syntax
        \item Verarbeitung gesamter Projektverzeichnisse
        \item Beibehaltung der Quelltextformatierung
      \end{enumerate}
    \end{frame}

    \begin{frame}
      \frametitle{Implementierung als Babel-Plugin}
      \begin{itemize}
        \item \textit{Babel}~\autocite{BABEL} als Grundlage der Implementierung
        \item Babel = Transpiler für JavaScript
        \item unterstützt alle geforderten Syntaxarten
        \item Erweiterung durch Plugins möglich
        % \item Programmtransformation durch Manipulation des abstrakten Syntaxbaums (AST)
      \end{itemize}
    \end{frame}

    \begin{frame}
      \frametitle{Programmtransformation durch Babel}
      \begin{enumerate}
        \item Parsen des Eingabequelltexts\linebreak$\Rightarrow$ abstrakter Syntaxbaum (AST) des Programms
        \item Programmtransformation durch Manipulation der AST-Knoten mittels \textit{Besucher-Entwurfsmuster}
        \item Generierung des Ausgabequelltexts
      \end{enumerate}
    \end{frame}

    \begin{frame}[fragile]
      \frametitle{Transformation des AST}

      \begin{columns}
        \begin{column}{.48\textwidth}
          \begin{lstlisting}[numbers=none]
// @flow
type Alias = mixed;
          \end{lstlisting}
          \vspace{5mm}
          \ttfamily
          \begin{forest}
            for tree = {l=1.6cm, s sep=0.4cm}
            [Program
              [TypeAlias, edge label={node[edge]{body}}
                [Identifier, edge label={node[edge]{id}}
                  [\enquote{Alias}, edge label={node[edge]{name}}]
                ]
                [MixedTypeAnnotation, edge label={node[edge]{right}}]
              ]
            ]
          \end{forest}
        \end{column}
        \begin{column}{.04\textwidth}

        \end{column}
        \begin{column}{.48\textwidth}
          \begin{lstlisting}[numbers=none]
  // TypeScript
  type Alias = unknown;
          \end{lstlisting}
          \vspace{5mm}
          \ttfamily
          \begin{forest}
            for tree = {l=1.6cm, s sep=0.5cm}
            [Program
              [TSTypeAliasDeclaration, edge label={node[edge]{body}}
                [Identifier, edge label={node[edge]{id}}
                  [\enquote{Alias}, edge label={node[edge]{name}}]
                ]
                [TSUnknownKeyword, edge label={node[edge]{typeAnnotation}}]
              ]
            ]
          \end{forest}
        \end{column}
      \end{columns}
    \end{frame}

    \begin{frame}[plain]
      % \frametitle{Architektur}
      \begin{columns}
        \column{\dimexpr\paperwidth-6mm}
        \begin{figure}
          \includegraphics[width=\textwidth]{src/figures/architecture-overview.pdf}
        \end{figure}
      \end{columns}
    \end{frame}

    \begin{frame}
      \frametitle{Spezialfälle}
      TODO: Spezialfälle der Transformation
    \end{frame}

  \section{Ergebnisse}
    \secframe{3}{Ergebnisse und\\*\hspace{2.05em}Auswertung}

    \begin{frame}
      \frametitle{Durchführung der Migration}

    \end{frame}

    \begin{frame}
      \frametitle{Erkennung weiterer Typ- und Programmfehler}


    \end{frame}

    \begin{frame}
      \frametitle{TODO}

    \end{frame}

  \section{Zusammenfassung}
    \secframe{4}{Zusammenfassung}

    \begin{frame}
      \frametitle{TODO}

    \end{frame}

    \begin{frame}
      \frametitle{TODO}

    \end{frame}

  \appendix

    \begin{frame}[noframenumbering,plain]
      % empty
    \end{frame}

  \section{Anhang}
    \setbeamertemplate{footline}{}

    \begin{frame}[noframenumbering]
      \frametitle{Evaluation bestehender Werkzeuge}
      \input{src/tables/tools.tex}
    \end{frame}

    \frame[allowframebreaks,noframenumbering,plain] {
      \frametitle{Quellenverzeichnis}
      \printbibliography
    }

\end{document}
